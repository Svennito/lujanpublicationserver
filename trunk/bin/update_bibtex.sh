#!/bin/bash
# To do 
# - check for existence of requried code, e.g. bibclean etc.
# - check for exit codes of each step
if [ "$1" == "" ]; then
  echo "Script to add and update bib files generated by gscholar.py"
  echo "to the bibtex database for further editing on the website etc."
  echo "Please call this with a name for which a bib file exists, "
  echo "but without the extension .bib:"
  echo ""
  echo "update_bibtex.sh HIPPO"
  echo ""
  echo "to update existing and insert new HIPPO entries."
  exit
fi

echo "Cleaning up the bib files from gscholar.py..."
bibclean $1.bib > $1_clean.bib 

echo "Created $1_clean.bib, ready for bibtosql..."
echo "Creating SQL statements for MySQL database..."
bibtosql_sv < $1_clean.bib > $1.sql
echo "SQL statements written to $1.sql."

echo "Sending SQL statements to database..."
mysql -u bibtex -pbibtex bibtex < $1.sql

